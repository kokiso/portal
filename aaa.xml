SELECT A.CNTC_CODCNTT       ,A.CNTC_CODGM       ,COALESCE(CNTP.CNTP_CODGMP,-1) AS CNTP_CODGMP       ,COALESCE(CNTP.CNTP_PLACACHASSI,'NSA0000') AS CNTP_PLACACHASSI       ,GMP.GMP_NUMSERIE       ,A.CNTC_VLRMENSAL       ,COALESCE(CONVERT(VARCHAR(10),CNTP.CNTP_DTATIVACAO,103),'*') AS CNTP_DTATIVACAO       ,CNTT.CNTT_MESES       ,CNTT.CNTT_DIA       ,CONVERT(VARCHAR(10),DateAdd(month, +(CNTT.CNTT_MESES-1), CNTT.CNTT_DTINICIO),103) AS ULTIMO_VENCTO       ,A.CNTC_CODSRV       ,SRV.SRV_NOME       ,SRV.SRV_CODPT       ,A.CNTC_PGTO       ,CNTT.CNTT_CODFVR       ,FVR.FVR_APELIDO       ,CNTT.CNTT_CODBNC       ,PT.PT_CODTD       ,PT.PT_CODFC       ,PT.PT_CODCC       ,CNTT.CNTT_CODEMP       ,COALESCE(EMP.EMP_APELIDO,'...') AS EMP_APELIDO       ,CNTT.CNTT_CODVND       ,VND.FVR_APELIDO AS VND_APELIDO       ,EMP.EMP_CODCDD       ,CNTT.CNTT_QTDAUTO       ,CAST(YEAR(CNTT.CNTT_DTINICIO) AS CHAR(4)) + RIGHT('0' + CAST(MONTH(CNTT.CNTT_DTINICIO) AS VARCHAR(2)),2) AS CMPINI       ,CAST(YEAR(DateAdd(month, +(CNTT.CNTT_MESES-1), CNTT.CNTT_DTINICIO)) AS CHAR(4))+RIGHT('0' + CAST(MONTH(DateAdd(month, +(CNTT.CNTT_MESES-1), CNTT.CNTT_DTINICIO)) AS VARCHAR(2)),2) AS CMPFIM       ,EOMONTH ( '2019-07-01' ) AS ULTIMODIAMES       ,COALESCE(datediff(day,CNTP.CNTP_DTATIVACAO,EOMONTH ( '2019-07-01' )),0) AS DIASINICIO  FROM CONTRATOCOBRANCA A  LEFT OUTER JOIN CONTRATO CNTT ON A.CNTC_CODCNTT=CNTT.CNTT_CODIGO  LEFT OUTER JOIN FAVORECIDO FVR ON CNTT.CNTT_CODFVR=FVR.FVR_CODIGO  LEFT OUTER JOIN EMPRESA EMP ON CNTT.CNTT_CODEMP=EMP.EMP_CODIGO  LEFT OUTER JOIN SERVICO SRV ON A.CNTC_CODSRV=SRV.SRV_CODIGO  LEFT OUTER JOIN PADRAOTITULO PT ON SRV.SRV_CODPT=PT.PT_CODIGO  LEFT OUTER JOIN FAVORECIDO VND ON CNTT.CNTT_CODVND=VND.FVR_CODIGO  LEFT OUTER JOIN CONTRATOPRODUTO CNTP ON A.CNTC_CODCNTT=CNTP.CNTP_CODCNTT AND A.CNTC_CODGM=CNTP.CNTP_CODGM  LEFT OUTER JOIN GRUPOMODELOPRODUTO GMP ON CNTP.CNTP_CODGMP=GMP.GMP_CODIGO  WHERE CNTP.CNTP_DTATIVACAO IS NOT NULL ORDER BY CNTP.CNTP_CODGMP,A.CNTC_CODSRV